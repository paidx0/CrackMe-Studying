运行看看<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694886095230-5d179ece-5d93-44d6-80c1-164adc3e2b94.png#averageHue=%23f8f8f7&clientId=udd2d8b94-a438-4&from=paste&height=301&id=ua3d8ef59&originHeight=602&originWidth=848&originalType=binary&ratio=2&rotation=0&showTitle=false&size=12965&status=done&style=none&taskId=u7d5bea29-9032-4896-bf95-e0ee86608ef&title=&width=424)<br />TASM/MASM 写的，无壳<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694886228969-7307af00-96d2-4984-9db7-825ec225a2fa.png#averageHue=%23c3d59f&clientId=udd2d8b94-a438-4&from=paste&height=276&id=u93642e0f&originHeight=552&originWidth=1062&originalType=binary&ratio=2&rotation=0&showTitle=false&size=118018&status=done&style=none&taskId=u74fbea27-d4cd-4c75-a7a2-d54ac03b20b&title=&width=531)<br />丢IDA静态分析一下，直接来看有什么字符串，了解个大概，发现了验证成功和失败的提示语<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694886725096-bbf2284d-29ca-4fe5-a315-b20e4c22edda.png#averageHue=%23f9f7f6&clientId=udd2d8b94-a438-4&from=paste&height=163&id=u2e8d7314&originHeight=326&originWidth=942&originalType=binary&ratio=2&rotation=0&showTitle=false&size=35889&status=done&style=none&taskId=uc47a02c4-42d9-4c70-b1f4-b6ee05f1e48&title=&width=471)<br />来看执行流程，start函数是程序允许入口，DialogBoxParamA生成对话框<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694890793167-e0801f9b-9725-4c2e-8be6-c7ebaa542ab7.png#averageHue=%23f8f7f7&clientId=udd2d8b94-a438-4&from=paste&height=143&id=u9896c52c&originHeight=286&originWidth=1038&originalType=binary&ratio=2&rotation=0&showTitle=false&size=26758&status=done&style=none&taskId=u00934651-6aae-4271-be04-98fdab1ca49&title=&width=519)<br />进到DialogFunc函数，两个函数，sub_40112D进去是EndDialog，也就是关闭对话框<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694894399388-dacf09b8-4b27-48b3-b400-7dd43a902c54.png#averageHue=%23fdfbfa&clientId=udd2d8b94-a438-4&from=paste&height=330&id=u45de2564&originHeight=660&originWidth=792&originalType=binary&ratio=2&rotation=0&showTitle=false&size=35109&status=done&style=none&taskId=uf4f5c4e0-463b-4cb4-a6b6-7ce7da8ca32&title=&width=396)<br />所以关注sub_401056函数，可以把看过的函数重命名，就比如sub_40112D改成Enddialog<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694895072474-a863c6ab-97c3-4e99-9346-50fbde223a2a.png#averageHue=%23fdfdf8&clientId=udd2d8b94-a438-4&from=paste&height=649&id=u0e2bc90a&originHeight=1298&originWidth=1342&originalType=binary&ratio=2&rotation=0&showTitle=false&size=185897&status=done&style=none&taskId=u066454b2-bf1b-4eaa-bc14-71b2d5bd164&title=&width=671)<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694895129388-fd68c2ac-f233-4858-aaf5-52cd7c4909f0.png#averageHue=%23fbfbfa&clientId=udd2d8b94-a438-4&from=paste&height=141&id=ufa4fb044&originHeight=282&originWidth=1294&originalType=binary&ratio=2&rotation=0&showTitle=false&size=34831&status=done&style=none&taskId=u3b61b295-a772-4660-8499-d7f44408284&title=&width=647)<br />流程清楚了，od动态调试验证下，打个断点<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694895825901-c404cac0-3ff0-4cf7-93aa-aca2f7bce9be.png#averageHue=%23262525&clientId=udd2d8b94-a438-4&from=paste&height=328&id=u65374215&originHeight=656&originWidth=1526&originalType=binary&ratio=2&rotation=0&showTitle=false&size=25881&status=done&style=none&taskId=u81d0185e-7502-44e1-8d57-14e105c4ff8&title=&width=763)<br />两次循环以后<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694896483305-3e481ab3-f50e-4514-a475-a21b041c84aa.png#averageHue=%23211f1f&clientId=udd2d8b94-a438-4&from=paste&height=465&id=ufd6f19e0&originHeight=930&originWidth=1560&originalType=binary&ratio=2&rotation=0&showTitle=false&size=45309&status=done&style=none&taskId=ue8c7d3f7-3b19-4ac0-bea2-fc7e179eeee&title=&width=780)<br />又两次拼接字符串之后，和我们输入的字符串比较，cmp不等，je跳转失败<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694896770666-5110a37d-946d-47d4-8d99-1db7b4eb2ed4.png#averageHue=%231c1919&clientId=udd2d8b94-a438-4&from=paste&height=439&id=u11925f6e&originHeight=878&originWidth=1832&originalType=binary&ratio=2&rotation=0&showTitle=false&size=51161&status=done&style=none&taskId=u8822e309-bb46-4361-916c-1924b2617e8&title=&width=916)<br />所以真实的序列号输入应该是L2C-57816784-ABEX<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694896967880-8e09c245-29e0-4a3e-9365-c64a1fd805ed.png#averageHue=%23f7f7f6&clientId=udd2d8b94-a438-4&from=paste&height=288&id=u7d42b1c6&originHeight=576&originWidth=800&originalType=binary&ratio=2&rotation=0&showTitle=false&size=13766&status=done&style=none&taskId=u4de8c5b2-b9aa-4aa9-9cf7-af20040435d&title=&width=400)
