![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694932655134-0c7863a5-252c-41ad-ac60-a7de9f3aba57.png#averageHue=%23b2b2b1&clientId=u12c457ec-4a05-4&from=paste&height=304&id=ud189e35e&originHeight=608&originWidth=756&originalType=binary&ratio=2&rotation=0&showTitle=false&size=19876&status=done&style=none&taskId=ud840e42c-7961-4b75-a412-d6202b186fc&title=&width=378)<br />有壳，需要脱壳<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694932696501-5631430b-9bd6-40a4-8149-94d1edc80b4f.png#averageHue=%23ccce97&clientId=u12c457ec-4a05-4&from=paste&height=281&id=u5af95c52&originHeight=562&originWidth=1100&originalType=binary&ratio=2&rotation=0&showTitle=false&size=119990&status=done&style=none&taskId=u0cb415f4-1be1-4a46-9b38-dae285d2aab&title=&width=550)<br />拖到od，第一行是pushad，直接F8，注意ESP改变了说明程序地址变了，ESP定律对esp下断点可以跳到真实的程序入口<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694934443180-68b7fcae-4039-4af1-8fea-5b6202c15cd6.png#averageHue=%23363636&clientId=u12c457ec-4a05-4&from=paste&height=399&id=ude9dfff3&originHeight=798&originWidth=2586&originalType=binary&ratio=2&rotation=0&showTitle=false&size=55960&status=done&style=none&taskId=u99676a6c-fd0b-4bed-8f54-bd5a31b3359&title=&width=1293)<br />F9断点断在一个jmp，F8来到真实入口<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694934645031-224ff309-1bcd-4432-8fc4-407c50e38a2a.png#averageHue=%230e0d0d&clientId=u12c457ec-4a05-4&from=paste&height=506&id=u87bb182a&originHeight=1012&originWidth=1702&originalType=binary&ratio=2&rotation=0&showTitle=false&size=23379&status=done&style=none&taskId=uec2b57dc-043c-4388-aa13-b9606dbda7f&title=&width=851)<br />右键简单脱壳，得到新的exe<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694934970869-010ed372-7585-43ec-9207-dcaf528659cc.png#averageHue=%23d7d6d5&clientId=u12c457ec-4a05-4&from=paste&height=217&id=u7264baf1&originHeight=434&originWidth=578&originalType=binary&ratio=2&rotation=0&showTitle=false&size=13411&status=done&style=none&taskId=uff13473b-d453-46e6-a1cb-4c047a53739&title=&width=289)<br />IDA查看，关键在call的那个函数做了什么，jnz只要不跳转就验证成功，跳转就到下面的失败了<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694936320237-1c5bd61c-4d43-424a-90a5-dc47e7661b4b.png#averageHue=%23fbfbfa&clientId=u12c457ec-4a05-4&from=paste&height=658&id=u35562ac0&originHeight=1316&originWidth=2012&originalType=binary&ratio=2&rotation=0&showTitle=false&size=218615&status=done&style=none&taskId=ud83a51a7-1470-4948-abaa-fbf11f45245&title=&width=1006)<br />我们输入123456，得到一个奇怪字符串，和他做比较，猜测这个就是正确的<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694936760279-227b8ccc-1849-472d-b4b4-42bd08689153.png#averageHue=%230f0e0c&clientId=u12c457ec-4a05-4&from=paste&height=168&id=u43d0425e&originHeight=336&originWidth=2236&originalType=binary&ratio=2&rotation=0&showTitle=false&size=170964&status=done&style=none&taskId=uacad3da1-bc9e-4796-86be-df21967f14d&title=&width=1118)<br />验证<br />![image.png](https://cdn.nlark.com/yuque/0/2023/png/22837360/1694936833854-16c280d2-e9a4-4ce1-94fd-652f00ee43ad.png#averageHue=%23a2a1a0&clientId=u12c457ec-4a05-4&from=paste&height=322&id=u94f0a2f9&originHeight=644&originWidth=722&originalType=binary&ratio=2&rotation=0&showTitle=false&size=20090&status=done&style=none&taskId=u60f96212-599e-424c-9468-39f34d8e687&title=&width=361)
